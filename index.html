<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get to Cornell</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <label for="address">Enter your address:</label>
        <input type="text" id="address" placeholder="14894 S Leland Rd, Beavercreek, OR 97004">

        <label for="date">Enter the date:</label>
        <input type="text" id="date" placeholder="YYYY-MM-DD">

        <button onclick="storeData()">Submit</button>
        <p id="resultMessageAddress"></p> <!-- Paragraph to display the result -->
        <p id="resultMessageDate"></p>
        <p id="debugUrl"></p>
        <p id="resultFlights"></p>
    </div>

    <div class="footer">
        <div class="social-icons">
            <a href="https://github.com/" target="_blank">
                <img src="images/github-mark.png" alt="GitHub Logo">
            </a>
            <a href="https://linkedin.com/" target="_blank">
                <img src="images/LI-In-Bug.png" alt="LinkedIn Logo">
            </a>
        </div>
        <p>Made by Lucas, Jack, and Duke @BigRed//Hacks 2024</p>
    </div>

    <script>
        function storeData() {
            const userAddress = document.getElementById("address").value.trim();
            const userDate = document.getElementById("date").value.trim();

            let messageAddress = '';
            let messageDate = '';

            if (userAddress) {
                messageAddress += "Address stored: " + userAddress;
            } else {
                messageAddress += "Please enter a valid address. ";
            }

            if (isValidDate(userDate)) {
                messageDate += "Date stored: " + userDate;
            } else {
                messageDate += "Enter a valid date.";
            }

            document.getElementById("resultMessageAddress").innerText = messageAddress;
            document.getElementById("resultMessageDate").innerText = messageDate;
            let formUrl = "http://34.66.120.146:5000/get?addr=" + userAddress + "&date=" + userDate;
            document.getElementById("debugUrl").innerText = formUrl;   
            document.getElementById("resultFlights").innerText = getFlights(formUrl);
        }

        function isValidDate(dateString) {
            // Check if date is in YYYY-MM-DD format
            const regex = /^\d{4}-\d{2}-\d{2}$/;
            if (!dateString.match(regex)) {
                return false;
            }

            // Parse the date parts to check if it's valid
            const parts = dateString.split("-");
            const year = parseInt(parts[0], 10);
            const month = parseInt(parts[1], 10);
            const day = parseInt(parts[2], 10);

            // Check the ranges of month and day
            if (year < 1000 || month < 1 || month > 12 || day < 1 || day > 31) {
                return false;
            }

            // Check for valid day range per month
            const monthDays = [31, (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
            return day <= monthDays[month - 1];
        }


        function getFlights(theUrl) {
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.open( "GET", theUrl, false ); // false for synchronous request
            xmlHttp.send( null );
            return xmlHttp.responseText;
        }

        
    </script>
</body>
</html>
